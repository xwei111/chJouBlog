<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>提升项目档次-自动化部署 | 追旅</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="

追旅初入前端时公司还是用ftp工具去部署项目，用的最熟练的命令就是rm -rf和cp，现在看来自己当 ...">
    
    <link rel="preload" href="/chJouBlog/assets/css/0.styles.7f9b6dec.css" as="style"><link rel="preload" href="/chJouBlog/assets/js/app.79c36648.js" as="script"><link rel="preload" href="/chJouBlog/assets/js/14.7d975c42.js" as="script"><link rel="preload" href="/chJouBlog/assets/js/3.e8def34d.js" as="script"><link rel="preload" href="/chJouBlog/assets/js/6.071d6b47.js" as="script"><link rel="prefetch" href="/chJouBlog/assets/js/10.978a1081.js"><link rel="prefetch" href="/chJouBlog/assets/js/11.3c8e8707.js"><link rel="prefetch" href="/chJouBlog/assets/js/12.83af8322.js"><link rel="prefetch" href="/chJouBlog/assets/js/13.9468ab6c.js"><link rel="prefetch" href="/chJouBlog/assets/js/15.f3544e63.js"><link rel="prefetch" href="/chJouBlog/assets/js/16.bdb7c496.js"><link rel="prefetch" href="/chJouBlog/assets/js/17.c1d0e25e.js"><link rel="prefetch" href="/chJouBlog/assets/js/18.f7c7aa38.js"><link rel="prefetch" href="/chJouBlog/assets/js/19.45786f76.js"><link rel="prefetch" href="/chJouBlog/assets/js/20.07b4c7e7.js"><link rel="prefetch" href="/chJouBlog/assets/js/21.ed8bd0de.js"><link rel="prefetch" href="/chJouBlog/assets/js/22.a3d589f4.js"><link rel="prefetch" href="/chJouBlog/assets/js/23.b593348c.js"><link rel="prefetch" href="/chJouBlog/assets/js/24.833a8cb4.js"><link rel="prefetch" href="/chJouBlog/assets/js/25.6b652bae.js"><link rel="prefetch" href="/chJouBlog/assets/js/26.7060b72f.js"><link rel="prefetch" href="/chJouBlog/assets/js/27.40ae073f.js"><link rel="prefetch" href="/chJouBlog/assets/js/28.1636752b.js"><link rel="prefetch" href="/chJouBlog/assets/js/29.f5da7651.js"><link rel="prefetch" href="/chJouBlog/assets/js/30.de90cbd7.js"><link rel="prefetch" href="/chJouBlog/assets/js/31.835179eb.js"><link rel="prefetch" href="/chJouBlog/assets/js/32.8c4e3060.js"><link rel="prefetch" href="/chJouBlog/assets/js/33.0904cf77.js"><link rel="prefetch" href="/chJouBlog/assets/js/34.b90b71d6.js"><link rel="prefetch" href="/chJouBlog/assets/js/35.9b6d726d.js"><link rel="prefetch" href="/chJouBlog/assets/js/36.18294513.js"><link rel="prefetch" href="/chJouBlog/assets/js/37.3874bcf3.js"><link rel="prefetch" href="/chJouBlog/assets/js/38.6b55341c.js"><link rel="prefetch" href="/chJouBlog/assets/js/39.e980f4ac.js"><link rel="prefetch" href="/chJouBlog/assets/js/4.957a0aab.js"><link rel="prefetch" href="/chJouBlog/assets/js/40.350e25b7.js"><link rel="prefetch" href="/chJouBlog/assets/js/41.18ac5dd8.js"><link rel="prefetch" href="/chJouBlog/assets/js/42.16187dba.js"><link rel="prefetch" href="/chJouBlog/assets/js/43.9edcdd06.js"><link rel="prefetch" href="/chJouBlog/assets/js/44.182ad560.js"><link rel="prefetch" href="/chJouBlog/assets/js/45.705eb48d.js"><link rel="prefetch" href="/chJouBlog/assets/js/46.fe2d4c0f.js"><link rel="prefetch" href="/chJouBlog/assets/js/47.df68d802.js"><link rel="prefetch" href="/chJouBlog/assets/js/48.583f4782.js"><link rel="prefetch" href="/chJouBlog/assets/js/49.7b5305c6.js"><link rel="prefetch" href="/chJouBlog/assets/js/5.d76e4066.js"><link rel="prefetch" href="/chJouBlog/assets/js/50.43c6a102.js"><link rel="prefetch" href="/chJouBlog/assets/js/51.69a9dee5.js"><link rel="prefetch" href="/chJouBlog/assets/js/52.1a2db978.js"><link rel="prefetch" href="/chJouBlog/assets/js/53.0426e610.js"><link rel="prefetch" href="/chJouBlog/assets/js/54.e8b3d6dc.js"><link rel="prefetch" href="/chJouBlog/assets/js/55.26128e21.js"><link rel="prefetch" href="/chJouBlog/assets/js/56.8f9fdad8.js"><link rel="prefetch" href="/chJouBlog/assets/js/57.31fb29d1.js"><link rel="prefetch" href="/chJouBlog/assets/js/58.84d078a7.js"><link rel="prefetch" href="/chJouBlog/assets/js/59.74a47f4b.js"><link rel="prefetch" href="/chJouBlog/assets/js/60.dc59e2f3.js"><link rel="prefetch" href="/chJouBlog/assets/js/61.181f5626.js"><link rel="prefetch" href="/chJouBlog/assets/js/62.a5bec828.js"><link rel="prefetch" href="/chJouBlog/assets/js/63.99d2483d.js"><link rel="prefetch" href="/chJouBlog/assets/js/64.6f70ca7c.js"><link rel="prefetch" href="/chJouBlog/assets/js/65.0970dde8.js"><link rel="prefetch" href="/chJouBlog/assets/js/66.1b3f4eb0.js"><link rel="prefetch" href="/chJouBlog/assets/js/67.df952f2c.js"><link rel="prefetch" href="/chJouBlog/assets/js/68.56d85d23.js"><link rel="prefetch" href="/chJouBlog/assets/js/69.882d2499.js"><link rel="prefetch" href="/chJouBlog/assets/js/7.4bf6c46c.js"><link rel="prefetch" href="/chJouBlog/assets/js/70.db416159.js"><link rel="prefetch" href="/chJouBlog/assets/js/71.e658e161.js"><link rel="prefetch" href="/chJouBlog/assets/js/72.7feffb48.js"><link rel="prefetch" href="/chJouBlog/assets/js/73.fdfae037.js"><link rel="prefetch" href="/chJouBlog/assets/js/74.bb027882.js"><link rel="prefetch" href="/chJouBlog/assets/js/75.794aecc7.js"><link rel="prefetch" href="/chJouBlog/assets/js/76.a214ff58.js"><link rel="prefetch" href="/chJouBlog/assets/js/77.8d3c8b74.js"><link rel="prefetch" href="/chJouBlog/assets/js/8.c3bbaf30.js"><link rel="prefetch" href="/chJouBlog/assets/js/9.4cbd8dcd.js"><link rel="prefetch" href="/chJouBlog/assets/js/vuejs-paginate.67f562ff.js">
    <link rel="stylesheet" href="/chJouBlog/assets/css/0.styles.7f9b6dec.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="vuepress-theme-blog__global-layout"><section id="header-wrapper"><header id="header"><div class="header-wrapper"><div class="title"><a href="/chJouBlog/" class="nav-link home-link">追旅 </a></div> <div class="header-right-wrap"><ul class="nav"><li class="nav-item"><a href="/chJouBlog/" class="nav-link">Blog</a></li><li class="nav-item"><a href="/chJouBlog/tag/" class="nav-link">Tags</a></li><li class="nav-item"><a href="/chJouBlog/author.html" class="nav-link">Author</a></li><li class="nav-item"><a href="/chJouBlog/log.html" class="nav-link">Log</a></li><li class="nav-item"><a href="https://github.com/xwei111/chJouBlog" target="_blank" rel="noopener noreferrer" class="nav-link external">GitHub</a></li><li class="nav-item"><a href="https://xwei111.github.io" target="_blank" rel="noopener noreferrer" class="nav-link external">XW-UI</a></li><li class="nav-item"><a href="https://ludd.link" target="_blank" rel="noopener noreferrer" class="nav-link external">Ludd</a></li></ul> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></div></header></section> <div id="mobile-header"><div class="mobile-header-bar"><div class="mobile-header-title"><a href="/chJouBlog/" class="nav-link mobile-home-link">追旅 </a> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></div> <div class="mobile-menu-wrapper"><hr class="menu-divider"> <ul class="mobile-nav"><li class="mobile-nav-item"><a href="/chJouBlog/" class="nav-link">Blog</a></li><li class="mobile-nav-item"><a href="/chJouBlog/tag/" class="nav-link">Tags</a></li><li class="mobile-nav-item"><a href="/chJouBlog/author.html" class="nav-link">Author</a></li><li class="mobile-nav-item"><a href="/chJouBlog/log.html" class="nav-link">Log</a></li><li class="mobile-nav-item"><a href="https://github.com/xwei111/chJouBlog" target="_blank" rel="noopener noreferrer" class="nav-link external">GitHub</a></li><li class="mobile-nav-item"><a href="https://xwei111.github.io" target="_blank" rel="noopener noreferrer" class="nav-link external">XW-UI</a></li><li class="mobile-nav-item"><a href="https://ludd.link" target="_blank" rel="noopener noreferrer" class="nav-link external">Ludd</a></li> <li class="mobile-nav-item"><!----></li></ul></div></div></div> <div class="content-wrapper"><div id="vuepress-theme-blog__post-layout"><article itemscope="itemscope" itemtype="https://schema.org/BlogPosting" class="vuepress-blog-theme-content"><header><h1 itemprop="name headline" class="post-title">
        提升项目档次-自动化部署
      </h1> <div class="post-meta"><div itemprop="publisher author" itemtype="http://schema.org/Person" itemscope="itemscope" class="post-meta-author"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-navigation"><polygon points="3 11 22 2 13 21 11 13 3 11"></polygon></svg> <span itemprop="name">追旅</span> <span itemprop="address">   in 杭州滨江</span></div> <div class="post-meta-date"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg> <time pubdate itemprop="datePublished" datetime="2021-06-24T00:00:00.000Z">
      Thu Jun 24 2021
    </time></div> <ul itemprop="keywords" class="post-meta-tags"><li class="post-tag" data-v-42ccfcd5><a href="/chJouBlog/tag/nginx" data-v-42ccfcd5><span data-v-42ccfcd5>nginx</span></a></li><li class="post-tag" data-v-42ccfcd5><a href="/chJouBlog/tag/github" data-v-42ccfcd5><span data-v-42ccfcd5>github</span></a></li><li class="post-tag" data-v-42ccfcd5><a href="/chJouBlog/tag/jenkins" data-v-42ccfcd5><span data-v-42ccfcd5>jenkins</span></a></li></ul></div></header> <div itemprop="articleBody" class="content__default"><h2 id="前言"><a href="#前言" class="header-anchor">#</a> 前言</h2> <p>追旅初入前端时公司还是用<code>ftp</code>工具去部署项目，用的最熟练的命令就是<code>rm -rf</code>和<code>cp</code>，现在看来自己当时还处于<code>冷兵器</code>时代，还傻傻的不自知。在之后的公司，除了部署方式不同，大多都开始使用<code>jenkins</code>去部署项目了，而随着前端工程化的深入人心，部署也已经是前端同学的必备技能，还真是学到老活到老，作为技术人还是要有技术人的觉悟的</p> <h2 id="github-actions"><a href="#github-actions" class="header-anchor">#</a> Github Actions</h2> <p><code>actions</code>是<code>github</code>19年11月正式推出的<code>CI/CD</code>服务，追旅的博客也是通过<code>actions</code>实现自动化部署到<code>github</code>的，而<code>actions</code>与其他部署相比较大的优点就是不需要使用者再去书写复杂的脚本，可以引用其他开发者已有的<code>actions</code>就可以了</p> <h3 id="基本术语"><a href="#基本术语" class="header-anchor">#</a> 基本术语</h3> <p><code>GitHub Actions</code>基本术语：</p> <ul><li>workflow</li></ul> <p>持续集成一次运行的过程，就是一个 workflow</p> <ul><li>job</li></ul> <p>一个 workflow 由一个或多个 jobs 构成，含义是一次持续集成的运行，可以完成多个任务</p> <ul><li>step</li></ul> <p>每个 job 由多个 step 构成，一步步完成</p> <ul><li>action</li></ul> <p>每个 step 可以依次执行一个或多个命令（action）</p> <h3 id="yml文件"><a href="#yml文件" class="header-anchor">#</a> yml文件</h3> <p><code>GitHub Actions</code>执行的脚本是<code>yml</code>文件，位置在<code>.github/workflow</code>下</p> <p>通常有两种配置方式：</p> <ol><li><p>通过github上的Actions选项直接配置，在github上配置完会直接commit一次，所以我们必须pull一次代码</p></li> <li><p>在本地工程里边新建<code>.github\workflows\main.yml</code>，在<code>main.yml</code>中配置ok后提交代码就可以了</p></li></ol> <h3 id="配置"><a href="#配置" class="header-anchor">#</a> 配置</h3> <p>这里以一份部署到<code>GitHub Pages</code>的配置为<code>demo</code>加上注释给大家看一下，<code>GitHub Pages</code>配置入口：<code>settings=&gt;GitHub Pages</code></p> <div class="language-yml extra-class"><pre class="language-yml"><code><span class="token comment"># workflow名称，命名一个自己看得懂的即可</span>
<span class="token key atrule">name</span><span class="token punctuation">:</span> Publish page
<span class="token comment"># on 是监听触发的动作，这里监听push代码的动作，触发部署</span>
<span class="token comment"># branches 代表的是分支，还可以配置tag和paths，或者配置branches-ignore、tags-ignore  、paths-ignore忽略分支、tag等</span>
<span class="token key atrule">on</span><span class="token punctuation">:</span>
  <span class="token key atrule">push</span><span class="token punctuation">:</span>
    <span class="token key atrule">branches</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> master
      
<span class="token comment"># schedule 可以配置schedule来定时触发部署，需要去了解一下cron表达式，这里选择手动部署</span>

<span class="token comment"># jobs 是我们将要做的事情</span>
<span class="token comment"># 建立一个名为build-and-deploy的job</span>
<span class="token comment"># runs-on 指定依赖的虚拟环境为ubuntu-latest</span>
<span class="token comment"># steps 下边开始各个步骤</span>
<span class="token comment"># name: Checkout 检索代码</span>
<span class="token comment"># 使用其他开发者的action:  actions/checkout@v2 </span>
<span class="token comment"># name: Install and Build 开始安装环境并打包</span>
<span class="token comment"># name: Deploy 开始部署，同样使用其他作者的现有action</span>
<span class="token comment"># width BRANCH 需要部署的分支：BRANCH</span>
<span class="token comment"># with FOLDER 需要部署的文件(即打包后的资源) blog/.vuepress/dist</span>
<span class="token key atrule">jobs</span><span class="token punctuation">:</span>
  <span class="token key atrule">build-and-deploy</span><span class="token punctuation">:</span>
    <span class="token key atrule">runs-on</span><span class="token punctuation">:</span> ubuntu<span class="token punctuation">-</span>latest
    <span class="token key atrule">steps</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Checkout
        <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/checkout@v2 
        <span class="token key atrule">with</span><span class="token punctuation">:</span>
          <span class="token key atrule">persist-credentials</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>

      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Install and Build 
        <span class="token key atrule">run</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string">
          npm install
          npm run build</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Deploy 
        <span class="token key atrule">uses</span><span class="token punctuation">:</span> JamesIves/github<span class="token punctuation">-</span>pages<span class="token punctuation">-</span>deploy<span class="token punctuation">-</span>action@releases/v3
        <span class="token key atrule">with</span><span class="token punctuation">:</span>
          <span class="token key atrule">GITHUB_TOKEN</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span><span class="token punctuation">{</span> secrets.GITHUB_TOKEN <span class="token punctuation">}</span><span class="token punctuation">}</span>
          <span class="token key atrule">BRANCH</span><span class="token punctuation">:</span> gh<span class="token punctuation">-</span>pages
          <span class="token key atrule">FOLDER</span><span class="token punctuation">:</span> blog/.vuepress/dist
</code></pre></div><p>可以看到<code>GitHub Actions</code>的部署方式相当的简单，很多关键地方可以使用现成的<code>action</code>，大大的降低的部署的成本，线上部署进度到<code>Github Actions</code>查看</p> <h2 id="jenkins-nginx"><a href="#jenkins-nginx" class="header-anchor">#</a> Jenkins &amp; nginx</h2> <p>大家可以先到<a href="https://www.aliyun.com/daily-act/ecs/free?utm_content=se_1009187272" target="_blank" rel="noopener noreferrer">阿里云<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>注册一个免费的服务器，大概有1-12月的样子，足够我们去做一些尝试了，不过配置过程的相当的痛苦（小白表示各种配置以及权限的问题，真滴能把人搞死了，说到底还是太弱了），追旅虚拟机用的是<code>ubuntu</code>,阿里云提供了多种链接虚拟机的方式，打击可以试一下，追旅也推荐一款连接服务器的工具<a href="https://mobaxterm.mobatek.net/" target="_blank" rel="noopener noreferrer">mobaxterm<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，下边是阿里云提供的方式</p> <p><img src="/chJouBlog/assets/img/20210624deploy1.067b46bc.png" alt="An image"></p> <p>使用阿里云<code>ssh</code>链接遇到问题时的几种处理方式:</p> <ol><li>到安全组中开启端口，例如<code>ssh</code>的端口默认为<code>22</code></li> <li>到<code>/etc/ssh/sshd_config</code>中看一下<code>PermitRootLogin</code>配置是否为<code>yes</code>并且注释关闭（#号删掉）</li> <li><code>ssh</code>无法链接，可以查看是否启动了<code>ssh</code>服务</li></ol> <p>其他的小问题不说了，更多问题自行查找吧</p> <h3 id="nginx"><a href="#nginx" class="header-anchor">#</a> nginx</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 安装 nginx</span>
apt<span class="token operator">-</span><span class="token keyword">get</span> install nginx
<span class="token comment">// 启动</span>
service nginx start
<span class="token comment">// 停止</span>
service nginx stop
<span class="token comment">// 重启</span>
service nginx restart
</code></pre></div><p>简单配置一下<code>nginx</code>，接下来作为我们测试项目的部署地址，配置文件在<code>/etc/nginx/nginx.conf</code>，添加如下配置：</p> <div class="language- extra-class"><pre class="language-text"><code>server {
  listen  8000;
  server_name  localhost;
  location / {
    root  test;
    index  index.html index.htm;
    try_files $uri $uri/ /index.html; // 对于history路由的配置
  }
  // 配置反向代理，以/lesscode/开头的请求指向http://47.98.126.233:3000
  location ^~/lesscode/ {
    proxy_pass http://47.98.126.233:3000;
  }
}
</code></pre></div><p>前端静态资源的部署地址是<code>/usr/share/nginx/</code>，可以自行创建<code>test</code>文件夹，并添加一个<code>html</code>页面看一下是否可以访问</p> <p><code>nginx</code>更多配置不在介绍，目前基本满足了我们自动化部署测试的需求，<code>nginx</code>很强大，追旅之后专门做一期的分享</p> <h3 id="jenkins"><a href="#jenkins" class="header-anchor">#</a> jenkins</h3> <p><code>jenkins</code>的安装启动方式和<code>nginx</code>一样，初始化<code>jenkins</code>不说了，假设我们现在以及启动了<code>jenkins</code>，接下来除了默认安装的插件外，需要额外安装两个插件：<code>NodeJS Plugin</code> 和 <code>Publish Over SSH</code>，一个是用来配置<code>node</code>环境，一个是用来连接远程服务，记得装完插件要重启<code>jenkins</code>服务</p> <p><code>jenkins</code>依赖<code>java</code>，阿里云的服务器没有<code>java</code>环境，记得自行安装一下</p> <h4 id="node"><a href="#node" class="header-anchor">#</a> node</h4> <p><code>node</code>的配置入口在<code>全局工具配置</code>，选择自己需要的<code>node</code>版本，<code>node</code>版本要和虚拟机安装的<code>node</code>保持一致</p> <p><img src="/chJouBlog/assets/img/20210624deploy2.e8216c44.png" alt="An image"></p> <h4 id="ssh"><a href="#ssh" class="header-anchor">#</a> ssh</h4> <p><code>ssh</code>配置入口在<code>系统配置</code></p> <p><img src="/chJouBlog/assets/img/20210624deploy3.f0daa68d.png" alt="An image"></p> <ul><li>name: 定义一个名称</li> <li>Hostname：服务器地址</li> <li>Username：登录用户</li> <li>Remote Directory：远程部署地址</li> <li>Passphrase / Password： 填写用户密码</li></ul> <p>填完这些保存即可</p> <h4 id="创建项目"><a href="#创建项目" class="header-anchor">#</a> 创建项目</h4> <p>起一个名称，选择一个自由风格的软件项目，当你有一个相同配置的项目时可以在下方复制那里输入项目名称，确定后会带出相同的配置</p> <p><img src="/chJouBlog/assets/img/20210624deploy4.fc8e5692.png" alt="An image"></p> <p>进入项目的配置，填写项目的名称，关联<code>git</code>地址，因为<code>github</code>网络不稳定，经常失败，这里选择了<code>码云</code></p> <p><img src="/chJouBlog/assets/img/20210624deploy5.6dc04725.png" alt="An image"></p> <p>指定分支</p> <p><img src="/chJouBlog/assets/img/20210624deploy6.c89a9278.png" alt="An image"></p> <p>我们这里选择手动触发，然后为了保证服务器上码云冗余的资源及资源是最新的，我们选择打包后、部署前删除上次部署在<code>nginx</code>的资
源</p> <p><img src="/chJouBlog/assets/img/20210624deploy7.e2b22acb.png" alt="An image"></p> <p>选择之前配置的<code>node</code></p> <p><img src="/chJouBlog/assets/img/20210624deploy8.a1a41091.png" alt="An image"></p> <p>编写打包脚本，这里使用<code>cnpm</code></p> <p><img src="data:image/png;base64,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" alt="An image"></p> <p>最后配置打包部署的操作，打包后的文件是<code>dist</code>，并且我们只需要部署<code>dist</code>中的内容</p> <p><img src="/chJouBlog/assets/img/20210624deploy10.04ef523c.png" alt="An image"></p> <p>基本到此，整个部署基本完成了，完事访问我们<code>nginx</code>配置的<code>8000</code>端口即可：<a href="http://47.98.126.233:8000/" target="_blank" rel="noopener noreferrer">访问地址<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="结语"><a href="#结语" class="header-anchor">#</a> 结语</h2> <p>完成一次简单的部署并不麻烦，但是从头搭一套还是蛮累的，因为在自己不熟悉的领域搞事情啥都得边查边搞，而且有些不知名的错误，但前端发展这么快，或者说技术发展这么快，不拓展自己的技术领域又能在技术路上走多久呢，一直做一些熟悉的事情，好像也会很无聊吧</p></div> <footer><!----> <hr> <!----></footer></article> <div class="sticker vuepress-toc"><div class="vuepress-toc-item vuepress-toc-h2 active"><a href="#前言" title="前言">前言</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#github-actions" title="Github Actions">Github Actions</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#基本术语" title="基本术语">基本术语</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#yml文件" title="yml文件">yml文件</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#配置" title="配置">配置</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#jenkins-nginx" title="Jenkins &amp; nginx">Jenkins &amp; nginx</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#nginx" title="nginx">nginx</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#jenkins" title="jenkins">jenkins</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#结语" title="结语">结语</a></div></div></div></div> <footer class="footer" data-v-3d9deeb8><div class="footer-left-wrap" data-v-3d9deeb8><ul class="contact" data-v-3d9deeb8><li class="contact-item" data-v-3d9deeb8><a href="https://github.com/xwei111/chJouBlog" target="_blank" rel="noopener noreferrer" class="nav-link external" data-v-3d9deeb8><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github" data-v-3d9deeb8><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22" data-v-3d9deeb8></path></svg>
          
        </a></li><li class="contact-item" data-v-3d9deeb8><a href="mailto:17681828640@163.com" class="nav-link external" data-v-3d9deeb8><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-mail" data-v-3d9deeb8><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z" data-v-3d9deeb8></path><polyline points="22,6 12,13 2,6" data-v-3d9deeb8></polyline></svg>
          
        </a></li></ul></div> <div class="footer-right-wrap" data-v-3d9deeb8><ul class="copyright" data-v-3d9deeb8><li class="copyright-item" data-v-3d9deeb8>追旅 © 2020</li></ul></div></footer></div><div class="global-ui"></div></div>
    <script src="/chJouBlog/assets/js/app.79c36648.js" defer></script><script src="/chJouBlog/assets/js/14.7d975c42.js" defer></script><script src="/chJouBlog/assets/js/3.e8def34d.js" defer></script><script src="/chJouBlog/assets/js/6.071d6b47.js" defer></script>
  </body>
</html>
